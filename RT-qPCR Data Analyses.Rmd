---
title: "RT-qPCR Data Analyses"
author: "Federico Martinez-Seidel"
date: "2023-05-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Import Data

```{r}

### example mutliple plates

PlatesDIRs = list("./20230622_ELG_TGFBTC_TR1_depurated.txt",
                 "./20230622_ELG_TGFBTC_tr2_depurated.txt",
                 "./20230622_ELG_TGFBTC_tr3_depurated.txt")

InputPathTreatmentFiles = "./Treatment_Table.txt"


### example 1 plate

PlatesDIRs = "./20230622_ELG_TGFBTC_TR1_depurated.txt"

InputPathTreatmentFiles0 = "./Treatment_Table.txt"

InputPathTreatmentFiles1 = read.table(InputPathTreatmentFiles0,
                                    fill = TRUE,
                                    header = T)[which(read.table(InputPathTreatmentFiles0,fill = TRUE, header = T)$Plate_ID == 1),]

write.table(file = "cropped_Treatment_Table.txt", x = InputPathTreatmentFiles1)

InputPathTreatmentFiles = "./cropped_Treatment_Table.txt"



### Parameters to differentiate controls

MinusRevTranscriptaseC_Pattern = "mRT"

MinusRevTranscriptaseC_boundary = 30

EmptyWells_Pattern = "_E"

EmptyWells_boundary = 15

H2O_Pattern = "_H2O"

H2O_boundary = 34



#### main development

running_example <- DeltaDeltaCtCc(qPCR_List_OR_Dir = PlatesDIRs,
                                  Treatment_Table_Dir = InputPathTreatmentFiles)





























### Reviewing controls

#### RT

MinusRevTranscriptaseC_runner <- running_example[grep(pattern = MinusRevTranscriptaseC_Pattern, x = running_example[,"gene_treat_ID"]),]

if( any(as.numeric(MinusRevTranscriptaseC_runner[,"Raw_Ct"]) > 0 & as.numeric(MinusRevTranscriptaseC_runner[,"Raw_Ct"]) < MinusRevTranscriptaseC_boundary) ) {
  
  warning("your minus RT controls are within the forbidden boundaries")
  
}

running_example1 = running_example[-c(grep(pattern = MinusRevTranscriptaseC_Pattern, x = running_example[,"gene_treat_ID"])),]

#### Empty wells

EmptyWells_runner <- running_example1[grep(pattern = EmptyWells_Pattern, x = running_example1[,"gene_treat_ID"]),]

if( any(as.numeric(EmptyWells_runner[,"Raw_Ct"]) > 0 & as.numeric(EmptyWells_runner[,"Raw_Ct"]) < EmptyWells_boundary) ) {
  
  warning("your empty wells are within the forbidden boundaries")
  
}

running_example2 = running_example1[-c(grep(pattern = EmptyWells_Pattern, x = running_example1[,"gene_treat_ID"])),]

#### H2O

H2O_runner <- running_example2[grep(pattern = H2O_Pattern, x = running_example2[,"gene_treat_ID"]),]

if( any(as.numeric(H2O_runner[,"Raw_Ct"]) > 0 & as.numeric(H2O_runner[,"Raw_Ct"]) < H2O_boundary) ) {
  
  warning("your H2O are within the forbidden boundaries")
  
}

running_example3 = running_example2[-c(grep(pattern = H2O_Pattern, x = running_example2[,"gene_treat_ID"])),]

### optional return controls

control_matrices_RawCts <- list(MinusRevTranscriptaseC_runner,
                                EmptyWells_runner,
                                H2O_runner)

### continue with calculating deltadeltaCts per plate (the assumption is that every biological replicate has been run in the same plate as its control; other scenarios imply non-accounted technical variance)


if (length(unique(as.numeric(running_example3[,"plate_ID"]))) != length(PlatesDIRs)) {
  
  stop("ERROR: number of plates differ from what is written in the Treatment File")
  
}



for (i in 1:length(PlatesDIRs)) {
  
  runner_plate_i <- running_example3[which(running_example3[,"plate_ID"] == unique(as.numeric(running_example3[,"plate_ID"]))[i]),]
  
  genes_runner <- apply(X = list2DF(strsplit(x = runner_plate_i[,"gene_treat_ID"], split = "_"))[1,], MARGIN = 2, FUN = as.character )
  
  remaining_DF <- list2DF(strsplit(x = runner_plate_i[,"gene_treat_ID"], split = "_"))[-1,]
  
  Treatment_IDs <- tidyr::unite(as.data.frame(t(remaining_DF)), col = "Treatment")
  
  Full_plate_runner_i <- cbind(Raw_Ct = runner_plate_i[,"Raw_Ct"], 
                               Gene_ID = genes_runner,
                               Treatment_ID = Treatment_IDs)
  
  
  treatments_iter <- unique(Full_plate_runner_i$Treatment)
  
  for (j in 1:length(treatments_iter)) {
    
    treatment_specific_df <- Full_plate_runner_i[grep(pattern = treatments_iter[j], Full_plate_runner_i$Treatment),]
    
    #### calculate DeltaCts by subtracting target genes from control ones:
    
    
  }
  
  
  #### calculate DeltaDeltaCts by using the formula 2**(-(Treated_abundances-Control_abundances))
    
}














### defining samples

minus_RT_controls <- paste0("A", c(1:7,9))

negative_water_controls <- paste0("H", 1:8)

empty_wells <- c(paste0("A", c(8,10:12)), paste0("H", 9:12))

PPIB <- c(paste0("B", 1:3), paste0("C", 1:3), paste0("D", 1:3))

FKBP10 <- c(paste0("B", 4:6), paste0("C", 4:6), paste0("D", 4:6))

LRP10 <- c(paste0("B", 7:9), paste0("C", 7:9), paste0("D", 7:9))

Col1A1 <- c(paste0("B", 10:12), paste0("C", 10:12), paste0("D", 10:12))

RTL8C <- c(paste0("E", 1:3), paste0("F", 1:3), paste0("G", 1:3))

PLD3 <- c(paste0("E", 4:6), paste0("F", 4:6), paste0("G", 4:6))

COL6A2 <- c(paste0("E", 7:9), paste0("F", 7:9), paste0("G", 7:9))

ProCol1A2 <- c(paste0("E", 10:12), paste0("F", 10:12), paste0("G", 10:12))

### getting the concentration values

minus_RT_controls_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", minus_RT_controls, "$", collapse = "|"), x = qPCR_table$V3)])

negative_water_controls_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", negative_water_controls, "$", collapse = "|"), x = qPCR_table$V3)])

empty_wells_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", empty_wells, "$", collapse = "|"), x = qPCR_table$V3)])


PPIB_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", PPIB, "$", collapse = "|"), x = qPCR_table$V3)])

FKBP10_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", FKBP10, "$", collapse = "|"), x = qPCR_table$V3)])

LRP10_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", LRP10, "$", collapse = "|"), x = qPCR_table$V3)])

Col1A1_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", Col1A1, "$", collapse = "|"), x = qPCR_table$V3)])

RTL8C_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", RTL8C, "$", collapse = "|"), x = qPCR_table$V3)])

PLD3_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", PLD3, "$", collapse = "|"), x = qPCR_table$V3)])

COL6A2_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", COL6A2, "$", collapse = "|"), x = qPCR_table$V3)])
  
ProCol1A2_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", ProCol1A2, "$", collapse = "|"), x = qPCR_table$V3)])

### Boxplot

box <- data.frame(names =  c(rep("minus_RT_controls_Ct", 8),
                             rep("negative_water_controls_Ct",8),
                             rep("empty_wells_Ct",8),
                             rep("PPIB_Ct",9),
                             rep("FKBP10_Ct",9),
                             rep("LRP10_Ct",9),
                             rep("Col1A1_Ct",9),
                             rep("RTL8C_Ct",9),
                             rep("PLD3_Ct",9),
                             rep("COL6A2_Ct",9),
                             rep("ProCol1A2_Ct",9)),
                  values = c(minus_RT_controls_Ct, negative_water_controls_Ct,empty_wells_Ct, PPIB_Ct, FKBP10_Ct, LRP10_Ct,Col1A1_Ct, RTL8C_Ct, PLD3_Ct, COL6A2_Ct,
                  ProCol1A2_Ct))

ggplot2::ggplot(box, ggplot2::aes(x = factor(names),
                                  y = values,
                                  fill = names)) +
  ggplot2::geom_boxplot(alpha = 0.80) +
  ggplot2::geom_point(ggplot2::aes(fill = names),
                      size = 5, shape = 21,
                      position = ggplot2::position_jitterdodge()) +
  ggplot2::theme(text = ggplot2::element_text(size = 18),
                 axis.title.x = ggplot2::element_blank(),
                 axis.title.y = ggplot2::element_blank(),
                 panel.grid.minor.x = ggplot2::element_blank(),
                 panel.grid.major.x = ggplot2::element_blank(),
                 legend.position = "none",
                 axis.text.x = ggplot2::element_text(angle = 90,
                                                     vjust = 0.5,
                                                     hjust=1))

```


```{r}

qPCR_table2 <- read.table("05262023_Collagen_Test2_Depurated.txt", fill = TRUE)

### defining samples

minus_RT_controls <- paste0("A", c(1:7))

negative_water_controls <- paste0("H", 1:7)

empty_wells <- c(paste0("A", c(8:12)), paste0("H", 8:12))

PPIB <- c(paste0("B", 1:3), paste0("C", 1:3), paste0("D", 1:3))

FKBP10 <- c(paste0("B", 4:6), paste0("C", 4:6), paste0("D", 4:6))

LRP10 <- c(paste0("B", 7:9), paste0("C", 7:9), paste0("D", 7:9))

Col1A1 <- c(paste0("B", 10:12), paste0("C", 10:12), paste0("D", 10:12))

RTL8C <- c(paste0("E", 1:3), paste0("F", 1:3), paste0("G", 1:3))

#PLD3 <- c(paste0("E", 4:6), paste0("F", 4:6), paste0("G", 4:6))

COL6A2 <- c(paste0("E", 7:9), paste0("F", 7:9), paste0("G", 7:9))

ProCol1A2 <- c(paste0("E", 10:12), paste0("F", 10:12), paste0("G", 10:12))

### getting the concentration values

minus_RT_controls_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", minus_RT_controls, "$", collapse = "|"), x = qPCR_table2$V3)])

negative_water_controls_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", negative_water_controls, "$", collapse = "|"), x = qPCR_table2$V3)])

empty_wells_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", empty_wells, "$", collapse = "|"), x = qPCR_table2$V3)])


PPIB_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", PPIB, "$", collapse = "|"), x = qPCR_table2$V3)])

FKBP10_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", FKBP10, "$", collapse = "|"), x = qPCR_table2$V3)])

LRP10_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", LRP10, "$", collapse = "|"), x = qPCR_table2$V3)])

Col1A1_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", Col1A1, "$", collapse = "|"), x = qPCR_table2$V3)])

RTL8C_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", RTL8C, "$", collapse = "|"), x = qPCR_table2$V3)])

#PLD3_Ct <- as.numeric(qPCR_table$V6[grep(pattern = paste0("^", PLD3, "$", collapse = "|"), x = qPCR_table$V3)])

COL6A2_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", COL6A2, "$", collapse = "|"), x = qPCR_table2$V3)])
  
ProCol1A2_Ct <- as.numeric(qPCR_table2$V6[grep(pattern = paste0("^", ProCol1A2, "$", collapse = "|"), x = qPCR_table2$V3)])

### Boxplot

box <- data.frame(names =  c(rep("minus_RT_controls_Ct", 7),
                             rep("negative_water_controls_Ct",7),
                             rep("empty_wells_Ct",10),
                             rep("PPIB_Ct",9),
                             rep("FKBP10_Ct",9),
                             rep("LRP10_Ct",9),
                             rep("Col1A1_Ct",9),
                             rep("RTL8C_Ct",9),
                             rep("COL6A2_Ct",9),
                             rep("ProCol1A2_Ct",9)),
                  values = c(minus_RT_controls_Ct, negative_water_controls_Ct,empty_wells_Ct, PPIB_Ct, FKBP10_Ct, LRP10_Ct,Col1A1_Ct, RTL8C_Ct, COL6A2_Ct, ProCol1A2_Ct))

ggplot2::ggplot(box, ggplot2::aes(x = factor(names),
                                  y = values,
                                  fill = names)) +
  ggplot2::geom_boxplot(alpha = 0.80) +
  ggplot2::geom_point(ggplot2::aes(fill = names),
                      size = 5, shape = 21,
                      position = ggplot2::position_jitterdodge()) +
  ggplot2::theme(text = ggplot2::element_text(size = 18),
                 axis.title.x = ggplot2::element_blank(),
                 axis.title.y = ggplot2::element_blank(),
                 panel.grid.minor.x = ggplot2::element_blank(),
                 panel.grid.major.x = ggplot2::element_blank(),
                 legend.position = "none",
                 axis.text.x = ggplot2::element_text(angle = 90,
                                                     vjust = 0.5,
                                                     hjust=1))

```

## qPCR of TGF-beta vs mock treated Hs27 cells

### importing data

```{r}

qPCR_table_Rep1 <- read.table("Fed_Collagen_TGF_S1_060123_Depurated.txt", fill = TRUE)

qPCR_table_Rep2_3 <- read.table("Fed_Collagen_TGF_S2-3_060123_Depurated.txt", fill = TRUE)

```

### replacing 34 or larger by 0

```{r}

qPCR_table_Rep1[which(as.numeric(qPCR_table_Rep1$V6[3:length(qPCR_table_Rep1$V6)]) >= 34) + rep(2, length(which(as.numeric(qPCR_table_Rep1$V6[3:length(qPCR_table_Rep1$V6)]) >= 34))), 6] <- 0

qPCR_table_Rep2_3[which(as.numeric(qPCR_table_Rep2_3$V6[3:length(qPCR_table_Rep2_3$V6)]) >= 34) + rep(2, length(which(as.numeric(qPCR_table_Rep2_3$V6[3:length(qPCR_table_Rep2_3$V6)]) >= 34))), 6] <- 0

```

### defining samples

```{r}

#### No Reverse Transcriptase Controls per gene (No DNA contaminations)

minus_RT_control_Col1A1 <- paste0("A", c(1,7))

minus_RT_control_PPIB <- paste0("A", c(2,8))

minus_RT_control_LRP10 <- paste0("A", c(3,9))

minus_RT_control_FKBP10 <- paste0("A", c(4,10))

minus_RT_control_ProCol1A2 <- paste0("A", c(5,11))

minus_RT_control_Col6A2 <- paste0("A", c(6,12))

#### Negative Only Water Controls per gene (clean reagents)

minus_water_control_Col1A1 <- paste0("H", c(1,7))

minus_water_control_PPIB <- paste0("H", c(2,8))

minus_water_control_LRP10 <- paste0("H", c(3,9))

minus_water_control_FKBP10 <- paste0("H", c(4,10))

minus_water_control_ProCol1A2 <- paste0("H", c(5,11))

minus_water_control_Col6A2 <- paste0("H", c(6,12))

#### Negative Empty Controls per gene (clean racks) - RACK1

empty_wells <- c(paste0("E", c(1:12)), paste0("F", 1:12), paste0("G", 1:12))

#### gene Cts - RACK1 - Treated

Col1A1_1_T <- c(paste0("B", 1), paste0("C", 1), paste0("D", 1))

PPIB_1_T <- c(paste0("B", 2), paste0("C", 2), paste0("D", 2))

LRP10_1_T <- c(paste0("B", 3), paste0("C", 3), paste0("D", 3))

FKBP10_1_T <- c(paste0("B", 4), paste0("C", 4), paste0("D", 4))

ProCol1A2_1_T <- c(paste0("B", 5), paste0("C", 5), paste0("D", 5))

COL6A2_1_T <- c(paste0("B", 6), paste0("C", 6), paste0("D", 6))

#### gene Cts - RACK1 - Controls

Col1A1_1_C <- c(paste0("B", 7), paste0("C", 7), paste0("D", 7))

PPIB_1_C <- c(paste0("B", 8), paste0("C", 8), paste0("D", 8))

LRP10_1_C <- c(paste0("B", 9), paste0("C", 9), paste0("D", 9))

FKBP10_1_C <- c(paste0("B", 10), paste0("C", 10), paste0("D", 10))

ProCol1A2_1_C <- c(paste0("B", 11), paste0("C", 11), paste0("D", 11))

COL6A2_1_C <- c(paste0("B", 12), paste0("C", 12), paste0("D", 12))

#### gene Cts - RACK2 - Treated

Col1A1_2_T <- c(paste0("B", 1), paste0("C", 1), paste0("D", 1),
                paste0("E", 1), paste0("F", 1), paste0("G", 1))

PPIB_2_T <- c(paste0("B", 2), paste0("C", 2), paste0("D", 2),
              paste0("E", 2), paste0("F", 2), paste0("G", 2))

LRP10_2_T <- c(paste0("B", 3), paste0("C", 3), paste0("D", 3),
               paste0("E", 3), paste0("F", 3), paste0("G", 3))

FKBP10_2_T <- c(paste0("B", 4), paste0("C", 4), paste0("D", 4),
                paste0("E", 4), paste0("F", 4), paste0("G", 4))

ProCol1A2_2_T <- c(paste0("B", 5), paste0("C", 5), paste0("D", 5),
                   paste0("E", 5), paste0("F", 5), paste0("G", 5))

COL6A2_2_T <- c(paste0("B", 6), paste0("C", 6), paste0("D", 6),
                paste0("E", 6), paste0("F", 6), paste0("G", 6))

#### gene Cts - RACK1 - Controls

Col1A1_2_C <- c(paste0("B", 7), paste0("C", 7), paste0("D", 7),
                paste0("E", 7), paste0("F", 7), paste0("G", 7))

PPIB_2_C <- c(paste0("B", 8), paste0("C", 8), paste0("D", 8),
              paste0("E", 8), paste0("F", 8), paste0("G", 8))

LRP10_2_C <- c(paste0("B", 9), paste0("C", 9), paste0("D", 9),
               paste0("E", 9), paste0("F", 9), paste0("G", 9))

FKBP10_2_C <- c(paste0("B", 10), paste0("C", 10), paste0("D", 10),
                paste0("E", 10), paste0("F", 10), paste0("G", 10))

ProCol1A2_2_C <- c(paste0("B", 11), paste0("C", 11), paste0("D", 11),
                   paste0("E", 11), paste0("F", 11), paste0("G", 11))

COL6A2_2_C <- c(paste0("B", 12), paste0("C", 12), paste0("D", 12),
                paste0("E", 12), paste0("F", 12), paste0("G", 12))


#### Keys for dataset

minus_RT_control_Col1A1
minus_RT_control_PPIB
minus_RT_control_LRP10
minus_RT_control_FKBP10
minus_RT_control_ProCol1A2

minus_water_control_Col1A1
minus_water_control_PPIB
minus_water_control_LRP10
minus_water_control_FKBP10 
minus_water_control_ProCol1A2
minus_water_control_Col6A2

Col1A1_1_T
PPIB_1_T
LRP10_1_T
FKBP10_1_T
ProCol1A2_1_T
COL6A2_1_T

Col1A1_1_C
PPIB_1_C
LRP10_1_C
FKBP10_1_C
ProCol1A2_1_C
COL6A2_1_C

Col1A1_2_T
PPIB_2_T
LRP10_2_T
FKBP10_2_T
ProCol1A2_2_T
COL6A2_2_T

Col1A1_2_C
PPIB_2_C
LRP10_2_C
FKBP10_2_C
ProCol1A2_2_C
COL6A2_2_C


```

### getting the concentration values (means from technical triplicates in all measured genes but not in the controls, leaving technical replication in the control shows how clean everything was)

```{r}
#### No Reverse Transcriptase Controls per gene (No DNA contaminations)

minus_RT_control_Col1A1_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_RT_control_Col1A1, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_RT_control_Col1A1, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_RT_control_PPIB_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_RT_control_PPIB, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                              as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_RT_control_PPIB, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_RT_control_LRP10_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_RT_control_LRP10, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                               as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_RT_control_LRP10, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_RT_control_FKBP10_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_RT_control_FKBP10, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_RT_control_FKBP10, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_RT_control_ProCol1A2_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_RT_control_ProCol1A2, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                   as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_RT_control_ProCol1A2, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_RT_control_COL6A2_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_RT_control_Col6A2, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_RT_control_Col6A2, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))


#### Negative Only Water Controls per gene (clean reagents)

minus_water_control_Col1A1_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_water_control_Col1A1, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_water_control_Col1A1, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_water_control_PPIB_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_water_control_PPIB, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_water_control_PPIB, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_water_control_LRP10_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_water_control_LRP10, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_water_control_LRP10, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_water_control_FKBP10_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_water_control_FKBP10, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_water_control_FKBP10, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_water_control_ProCol1A2_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_water_control_ProCol1A2, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_water_control_ProCol1A2, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

minus_water_control_COL6A2_Ct <- c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", minus_water_control_Col6A2, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", minus_water_control_Col6A2, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)]))

#### Negative Empty Controls per gene (clean racks) - RACK1

empty_wells_Ct <- as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", empty_wells, "$", collapse = "|"), x = qPCR_table_Rep1$V3)])


#### gene replicated Cts - Treated

Col1A1_T_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", Col1A1_1_T, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", Col1A1_2_T, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

PPIB_T_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", PPIB_1_T, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", PPIB_2_T, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

LRP10_T_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", LRP10_1_T, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", LRP10_2_T, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

FKBP10_T_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", FKBP10_1_T, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", FKBP10_2_T, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

ProCol1A2_T_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", ProCol1A2_1_T, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", ProCol1A2_2_T, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

COL6A2_T_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", COL6A2_1_T, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", COL6A2_2_T, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

#### gene replicated Cts - Control

Col1A1_C_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", Col1A1_1_C, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", Col1A1_2_C, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

PPIB_C_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", PPIB_1_C, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", PPIB_2_C, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

LRP10_C_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", LRP10_1_C, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", LRP10_2_C, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

FKBP10_C_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", FKBP10_1_C, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", FKBP10_2_C, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

ProCol1A2_C_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", ProCol1A2_1_C, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", ProCol1A2_2_C, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])

COL6A2_C_Ct <- as.numeric(aggregate(c(as.numeric(qPCR_table_Rep1$V6[grep(pattern = paste0("^", COL6A2_1_C, "$", collapse = "|"), x = qPCR_table_Rep1$V3)]),
                                      
  as.numeric(qPCR_table_Rep2_3$V6[grep(pattern = paste0("^", COL6A2_2_C, "$", collapse = "|"), x = qPCR_table_Rep2_3$V3)])) ~ rep(c("S1","S2","S3"), 3), FUN = mean)[,2])


#### Keys RAW Cts for dataset

vec_RAW_CCTTs <- c(minus_water_control_Col1A1_Ct, minus_water_control_PPIB_Ct, minus_water_control_LRP10_Ct, minus_water_control_FKBP10_Ct, minus_water_control_ProCol1A2_Ct, minus_water_control_COL6A2_Ct, empty_wells_Ct, Col1A1_T_Ct, PPIB_T_Ct, LRP10_T_Ct, FKBP10_T_Ct, ProCol1A2_T_Ct, COL6A2_T_Ct, Col1A1_C_Ct, PPIB_C_Ct, LRP10_C_Ct, FKBP10_C_Ct, ProCol1A2_C_Ct, COL6A2_C_Ct)

names(vec_RAW_CCTTs) <- c(rep("minus_water_control_Col1A1_Ct", length(minus_water_control_Col1A1_Ct)),
                          rep("minus_water_control_PPIB_Ct", length(minus_water_control_PPIB_Ct)),
                          rep("minus_water_control_LRP10_Ct", length(minus_water_control_LRP10_Ct)),
                          rep("minus_water_control_FKBP10_Ct", length(minus_water_control_FKBP10_Ct)),
                          rep("minus_water_control_ProCol1A2_Ct", length(minus_water_control_ProCol1A2_Ct)),
                          rep("minus_water_control_COL6A2_Ct", length(minus_water_control_COL6A2_Ct)),
                          rep("empty_wells_Ct", length(empty_wells_Ct)),
                          rep("Col1A1_T_Ct", length(Col1A1_T_Ct)),
                          rep("PPIB_T_Ct", length(PPIB_T_Ct)),
                          rep("LRP10_T_Ct", length(LRP10_T_Ct)),
                          rep("FKBP10_T_Ct", length(FKBP10_T_Ct)),
                          rep("ProCol1A2_T_Ct", length(ProCol1A2_T_Ct)),
                          rep("COL6A2_T_Ct", length(COL6A2_T_Ct)),
                          rep("Col1A1_C_Ct", length(Col1A1_C_Ct)),
                          rep("PPIB_C_Ct", length(PPIB_C_Ct)),
                          rep("LRP10_C_Ct", length(LRP10_C_Ct)),
                          rep("FKBP10_C_Ct", length(FKBP10_C_Ct)),
                          rep("ProCol1A2_C_Ct", length(ProCol1A2_C_Ct)),
                          rep("COL6A2_C_Ct", length(COL6A2_C_Ct)))

write.csv2(x = cbind(Treatment = names(vec_RAW_CCTTs),
                     Ct_Value = vec_RAW_CCTTs), file = "RAW_Cts.csv",
           row.names = F, quote = F)

```

### Plotting RAW Cts with their respective controls

```{r}

Gene_vec <- c("Col1A1", "PPIB", "LRP10",
              "FKBP10", "ProCol1A2", "COL6A2")

#pdf("Plots_Cts_qPCR.pdf")

for (j in 1:length(Gene_vec)) {

  Objects2formFactVec <- grep(pattern = "Ct",
                              ls(pattern = Gene_vec[j]),
                              value = T)

  out_vec <- c()

  out_vec_names <- c()

  for (i in 1:length(Objects2formFactVec)) {
  
    out_vec <- c(out_vec, as.numeric(get(Objects2formFactVec[i])))
    
    out_vec_names <- c(out_vec_names, rep(x = Objects2formFactVec[i],
                                          length(get(Objects2formFactVec[i]))))
  
  }

  box <- data.frame(names =  out_vec_names,
                    values = out_vec)


  ggplot_x <- ggplot2::ggplot(box, ggplot2::aes(x = factor(names),
                                    y = values,
                                    fill = names)) +
              ggplot2::geom_boxplot(alpha = 0.80) +
              ggplot2::geom_point(ggplot2::aes(fill = names),
                                  size = 5, shape = 21,
                                  position = ggplot2::position_jitterdodge()) +
              ggplot2::theme(text = ggplot2::element_text(size = 18),
                             axis.title.x = ggplot2::element_blank(),
                             axis.title.y = ggplot2::element_blank(),
                             panel.grid.minor.x = ggplot2::element_blank(),
                             panel.grid.major.x = ggplot2::element_blank(),
                             legend.position = "none",
                             axis.text.x = ggplot2::element_text(angle = 90,
                                                                 vjust = 0.5,
                                                                 hjust=1))
  
  #print()
  
  ggplot2::ggsave(filename = paste0(paste0(Reduce(f = intersect, x = strsplit(out_vec_names, split = "_")), collapse = "_"), "_ControlsPlot.jpeg"), plot = ggplot_x, device = "jpeg", width = 5, height = 5)
    
}

#dev.off()

```

### Normalizing everything against everything to select the most appropriate control genes

```{r}

combi_gene_pairs <- gtools::permutations(n = length(Gene_vec), r = 2, v = Gene_vec, set = F, repeats.allowed = T)

#pdf("Norm_qPCR_Values.pdf")

out_deltaCt_T <- c()

out_names_deltaCt_T <- c()

out_deltaCt_C <- c()

out_names_deltaCt_C <- c()

out_vec4 <- c()

out_vec4_names <- c()

for (i in 1:nrow(combi_gene_pairs)) {
  
  Target_gene_runner <- as.character(combi_gene_pairs[i,])[1]
  
  Reference_gene_runner <- as.character(combi_gene_pairs[i,])[2]
  
  #### getting only treatments for target gene
  
  objects_targer_runner <- grep(pattern = "Ct",
     ls(pattern = Target_gene_runner),
     value = T)[-c(grep("control",grep(pattern = "Ct",
                                       ls(pattern = Target_gene_runner),
                                       value = T)))]
  
  out_vec2 <- c()
  
  out_vec_names2 <- c()
  
  for (j in 1:length(objects_targer_runner)) {
  
    out_vec2 <- c(out_vec2, as.numeric(get(objects_targer_runner[j])))
    
    out_vec_names2 <- c(out_vec_names2, rep(x = objects_targer_runner[j],
                         length(get(objects_targer_runner[j]))))
  
  }
  
  names(out_vec2) <- out_vec_names2
  
  #### getting only treatments for reference gene
  
  objects_ref_runner <- grep(pattern = "Ct",
     ls(pattern = Reference_gene_runner),
     value = T)[-c(grep("control",grep(pattern = "Ct",
                                       ls(pattern = Reference_gene_runner),
                                       value = T)))]
  
  out_vec3 <- c()
  
  out_vec_names3 <- c()
  
  for (j in 1:length(objects_ref_runner)) {
  
    out_vec3 <- c(out_vec3, as.numeric(get(objects_ref_runner[j])))
    
    out_vec_names3 <- c(out_vec_names3, rep(x = objects_ref_runner[j],
                         length(get(objects_ref_runner[j]))))
  
  }
  
  names(out_vec3) <- out_vec_names3
  
  Norm_Gene_Runner <- out_vec2 - out_vec3 #### delta Ct
  
  names(Norm_Gene_Runner) <- paste0(names(out_vec2), "_", names(out_vec3))
  
  #### delta delta Ct
  
  factor_genes_runner <- aggregate(as.numeric(Norm_Gene_Runner) ~ as.factor(names(Norm_Gene_Runner)), FUN = mean)[,1]
  
  factor_C_abundances <- Norm_Gene_Runner[grep(pattern = factor_genes_runner[1], x = names(Norm_Gene_Runner))]
  
  factor_T_abundances <- Norm_Gene_Runner[grep(pattern = factor_genes_runner[2], x = names(Norm_Gene_Runner))]
  
  deltaCt_T <- factor_T_abundances
    
  deltaCt_C <- factor_C_abundances
  
  out_deltaCt_T <- c(out_deltaCt_T, deltaCt_T)
  
  out_names_deltaCt_T <- c(out_names_deltaCt_T, names(factor_T_abundances))
  
  out_deltaCt_C <- c(out_deltaCt_C, deltaCt_C)
  
  out_names_deltaCt_C <- c(out_names_deltaCt_C, names(factor_C_abundances))
  
  deltadeltaCt <- 2**(-(factor_T_abundances-factor_C_abundances))
  
  FC_gene_runner <- round(mean(deltadeltaCt), 3) #round(log2(aggregate(as.numeric(Norm_Gene_Runner) ~ as.factor(names(Norm_Gene_Runner)), FUN = mean)[1,2]/aggregate(as.numeric(Norm_Gene_Runner) ~ as.factor(names(Norm_Gene_Runner)), FUN = mean)[2,2]), 3)
  
  names(FC_gene_runner) <- "delta delta Ct"  #paste0(aggregate(as.numeric(Norm_Gene_Runner) ~ as.factor(names(Norm_Gene_Runner)), FUN = mean)[1,1],"/",aggregate(as.numeric(Norm_Gene_Runner) ~ as.factor(names(Norm_Gene_Runner)), FUN = mean)[2,1])
  
  #par(mar=c(15,5,5,5)); RandoDiStats::TukeyCustomized(variable = as.numeric(Norm_Gene_Runner),
   #                           factor = as.factor(names(Norm_Gene_Runner)),
    #                          returnObject = "Letters", 
     #                         MainTitle = paste0(names(FC_gene_runner),
      #                                           ": ", FC_gene_runner),
       #                       ylabTukeys = "Normalized Gene Ct Values")
  
  
  out_vec4 <- c(out_vec4, deltadeltaCt)
  
  out_vec4_names <- c(out_vec4_names, names(deltadeltaCt))
  
}

##### inspecting Delta Ct ratio errors

write.csv2(cbind(out_names_deltaCt_T, out_deltaCt_T, out_names_deltaCt_C, out_deltaCt_C), file = "Table_Delta_Ct.csv", row.names = F, col.names = NULL)

##### everything seems to be correct, the nature of expression values nullify the variance in replicates

#dev.off()

box <- data.frame(names =  out_vec4_names,
                    values = out_vec4)


  ggplot_x <- ggplot2::ggplot(box, ggplot2::aes(x = factor(names),
                                    y = values,
                                    fill = names)) +
              ggplot2::geom_boxplot(alpha = 0.80) +
              ggplot2::geom_point(ggplot2::aes(fill = names),
                                  size = 5, shape = 21,
                                  position = ggplot2::position_jitterdodge()) +
              ggplot2::theme(text = ggplot2::element_text(size = 18),
                             axis.title.x = ggplot2::element_blank(),
                             axis.title.y = ggplot2::element_blank(),
                             panel.grid.minor.x = ggplot2::element_blank(),
                             panel.grid.major.x = ggplot2::element_blank(),
                             legend.position = "none",
                             axis.text.x = ggplot2::element_text(angle = 90,
                                                                 vjust = 0.5,
                                                                 hjust=1))
  
  print(ggplot_x)

```

### Doing stats with the selected genes and normalized delta delta Ct values

```{r}

#### COL1A1

Col1A1_vs_FKBP10 <- grep(pattern = "FKBP10", x = grep(pattern = 'Col1A1', x = out_vec4_names, value = T), value = F)[1:3]

Col1A1_vs_LRP10 <- grep(pattern = "LRP10", x = grep(pattern = 'Col1A1', x = out_vec4_names, value = T), value = F)[1:3]

Col1A1_vs_PPIB <- grep(pattern = "PPIB", x = grep(pattern = 'Col1A1', x = out_vec4_names, value = T), value = F)[1:3]

#### ProCol1A2

ProCol1A2_vs_FKBP10 <- grep(pattern = "FKBP10", x = grep(pattern = 'ProCol1A2', x = out_vec4_names, value = T), value = F)[4:6]

ProCol1A2_vs_LRP10 <- grep(pattern = "LRP10", x = grep(pattern = 'ProCol1A2', x = out_vec4_names, value = T), value = F)[4:6]

ProCol1A2_vs_PPIB <- grep(pattern = "PPIB", x = grep(pattern = 'ProCol1A2', x = out_vec4_names, value = T), value = F)[4:6]

#### Controls Among Them

PPIB_vs_FKBP10 <- grep(pattern = "FKBP10", x = grep(pattern = 'PPIB', x = out_vec4_names, value = T), value = F)[1:3]

PPIB_vs_LRP10 <- grep(pattern = "LRP10", x = grep(pattern = 'PPIB', x = out_vec4_names, value = T), value = F)[1:3]

FKBP10_vs_PPIB <- grep(pattern = "PPIB", x = grep(pattern = 'FKBP10', x = out_vec4_names, value = T), value = F)[4:6]

FKBP10_vs_LRP10 <- grep(pattern = "LRP10", x = grep(pattern = 'FKBP10', x = out_vec4_names, value = T), value = F)[4:6]

LRP10_vs_PPIB <- grep(pattern = "PPIB", x = grep(pattern = 'LRP10', x = out_vec4_names, value = T), value = F)[4:6]

LRP10_vs_FKBP10 <- grep(pattern = "FKBP10", x = grep(pattern = 'LRP10', x = out_vec4_names, value = T), value = F)[1:3]

#### using all indexes to build variable and factor

variable_delta_delta_Cts_Sel <- c(rep(1, 3),
                                  out_vec4[grep(pattern = 'Col1A1', x = out_vec4_names, value = F)[Col1A1_vs_FKBP10]],
                                  out_vec4[grep(pattern = 'Col1A1', x = out_vec4_names, value = F)[Col1A1_vs_LRP10]],
                                  out_vec4[grep(pattern = 'Col1A1', x = out_vec4_names, value = F)[Col1A1_vs_PPIB]],
                                  out_vec4[grep(pattern = 'ProCol1A2', x = out_vec4_names, value = F)[ProCol1A2_vs_FKBP10]],
                                  out_vec4[grep(pattern = 'ProCol1A2', x = out_vec4_names, value = F)[ProCol1A2_vs_LRP10]],
                                  out_vec4[grep(pattern = 'ProCol1A2', x = out_vec4_names, value = F)[ProCol1A2_vs_PPIB]],
                                  out_vec4[grep(pattern = 'PPIB', x = out_vec4_names, value = F)[PPIB_vs_FKBP10]],
                                  out_vec4[grep(pattern = 'PPIB', x = out_vec4_names, value = F)[PPIB_vs_LRP10]],
                                  out_vec4[grep(pattern = 'FKBP10', x = out_vec4_names, value = F)[FKBP10_vs_PPIB]],
                                  out_vec4[grep(pattern = 'FKBP10', x = out_vec4_names, value = F)[FKBP10_vs_LRP10]],
                                  out_vec4[grep(pattern = 'LRP10', x = out_vec4_names, value = F)[LRP10_vs_PPIB]],
                                  out_vec4[grep(pattern = 'LRP10', x = out_vec4_names, value = F)[LRP10_vs_FKBP10]])

factor_delta_delta_Cts_Sel <- as.factor(c(rep("control", 3),
                                  grep(pattern = 'Col1A1', x = out_vec4_names, value = T)[Col1A1_vs_FKBP10],
                                  grep(pattern = 'Col1A1', x = out_vec4_names, value = T)[Col1A1_vs_LRP10],
                                  grep(pattern = 'Col1A1', x = out_vec4_names, value = T)[Col1A1_vs_PPIB],
                                  grep(pattern = 'ProCol1A2', x = out_vec4_names, value = T)[ProCol1A2_vs_FKBP10],
                                  grep(pattern = 'ProCol1A2', x = out_vec4_names, value = T)[ProCol1A2_vs_LRP10],
                                  grep(pattern = 'ProCol1A2', x = out_vec4_names, value = T)[ProCol1A2_vs_PPIB],
                                  grep(pattern = 'PPIB', x = out_vec4_names, value = T)[PPIB_vs_FKBP10],
                                  grep(pattern = 'PPIB', x = out_vec4_names, value = T)[PPIB_vs_LRP10],
                                  grep(pattern = 'FKBP10', x = out_vec4_names, value = T)[FKBP10_vs_PPIB],
                                  grep(pattern = 'FKBP10', x = out_vec4_names, value = T)[FKBP10_vs_LRP10],
                                  grep(pattern = 'LRP10', x = out_vec4_names, value = T)[LRP10_vs_PPIB],
                                  grep(pattern = 'LRP10', x = out_vec4_names, value = T)[LRP10_vs_FKBP10]))

factor_delta_delta_Cts_Sel <- factor(x = factor_delta_delta_Cts_Sel, levels = c("Col1A1_T_Ct_FKBP10_T_Ct","Col1A1_T_Ct_LRP10_T_Ct","Col1A1_T_Ct_PPIB_T_Ct","ProCol1A2_T_Ct_FKBP10_T_Ct","ProCol1A2_T_Ct_LRP10_T_Ct","ProCol1A2_T_Ct_PPIB_T_Ct","control","FKBP10_T_Ct_LRP10_T_Ct","LRP10_T_Ct_FKBP10_T_Ct","FKBP10_T_Ct_PPIB_T_Ct","PPIB_T_Ct_FKBP10_T_Ct","LRP10_T_Ct_PPIB_T_Ct","PPIB_T_Ct_LRP10_T_Ct"))

#### Stats

par(mar=c(15,5,2,2));
RandoDiStats::TukeyCustomized(variable = variable_delta_delta_Cts_Sel, 
                              factor = factor_delta_delta_Cts_Sel,
                              returnObject = "Letters")





```

### Ratios of alpha1 versus alpha2 chains

```{r}

#### RAW Ct

RandoDiStats::TukeyCustomized(variable = as.numeric(c(Col1A1_C_Ct, Col1A1_T_Ct)-c(ProCol1A2_C_Ct, ProCol1A2_T_Ct)),
                              factor = as.factor(c(rep("Control", 3), rep("Treatment", 3))), returnObject = "Letters", ylabTukeys = "Ct(COL1A1) - Ct(COL1A2)", MainTitle = "TGF-beta Treatment")

#### Normalized Ct

##### COL1A1_T

Col1A1_vs_FKBP10_T <- grep(pattern = "FKBP10", x = grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = T), value = F)[1:3]

Col1A1_vs_LRP10_T <- grep(pattern = "LRP10", x = grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = T), value = F)[1:3]

Col1A1_vs_PPIB_T <- grep(pattern = "PPIB", x = grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = T), value = F)[1:3]

##### COL1A1_C

Col1A1_vs_FKBP10_C <- grep(pattern = "FKBP10", x = grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = T), value = F)[1:3]

Col1A1_vs_LRP10_C <- grep(pattern = "LRP10", x = grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = T), value = F)[1:3]

Col1A1_vs_PPIB_C <- grep(pattern = "PPIB", x = grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = T), value = F)[1:3]

##### ProCol1A2_T

ProCol1A2_vs_FKBP10_T <- grep(pattern = "FKBP10", x = grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = T), value = F)[4:6]

ProCol1A2_vs_LRP10_T <- grep(pattern = "LRP10", x = grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = T), value = F)[4:6]

ProCol1A2_vs_PPIB_T <- grep(pattern = "PPIB", x = grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = T), value = F)[4:6]

##### ProCol1A2

ProCol1A2_vs_FKBP10_C <- grep(pattern = "FKBP10", x = grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = T), value = F)[4:6]

ProCol1A2_vs_LRP10_C <- grep(pattern = "LRP10", x = grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = T), value = F)[4:6]

ProCol1A2_vs_PPIB_C <- grep(pattern = "PPIB", x = grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = T), value = F)[4:6]

#### using all indexes to build variable and factor _ TREATMENT

variable_delta_Cts_Sel_T <- c(
                                  out_deltaCt_T[grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = F)[Col1A1_vs_FKBP10_T]],
                                  out_deltaCt_T[grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = F)[Col1A1_vs_LRP10_T]],
                                  out_deltaCt_T[grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = F)[Col1A1_vs_PPIB_T]],
                                  out_deltaCt_T[grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = F)[ProCol1A2_vs_FKBP10_T]],
                                  out_deltaCt_T[grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = F)[ProCol1A2_vs_LRP10_T]],
                                  out_deltaCt_T[grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = F)[ProCol1A2_vs_PPIB_T]])


factor_delta_Cts_Sel_T <- as.factor(c(
                                  grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = T)[Col1A1_vs_FKBP10_C],
                                  grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = T)[Col1A1_vs_LRP10_C],
                                  grep(pattern = 'Col1A1', x = out_names_deltaCt_T, value = T)[Col1A1_vs_PPIB_C],
                                  grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = T)[ProCol1A2_vs_FKBP10_C],
                                  grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = T)[ProCol1A2_vs_LRP10_C],
                                  grep(pattern = 'ProCol1A2', x = out_names_deltaCt_T, value = T)[ProCol1A2_vs_PPIB_C]))

#### using all indexes to build variable and factor - CONTROL

variable_delta_Cts_Sel_C <- c(
                                  out_deltaCt_C[grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = F)[Col1A1_vs_FKBP10]],
                                  out_deltaCt_C[grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = F)[Col1A1_vs_LRP10]],
                                  out_deltaCt_C[grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = F)[Col1A1_vs_PPIB]],
                                  out_deltaCt_C[grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = F)[ProCol1A2_vs_FKBP10]],
                                  out_deltaCt_C[grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = F)[ProCol1A2_vs_LRP10]],
                                  out_deltaCt_C[grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = F)[ProCol1A2_vs_PPIB]])


factor_delta_Cts_Sel_C <- as.factor(c(
                                  grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = T)[Col1A1_vs_FKBP10],
                                  grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = T)[Col1A1_vs_LRP10],
                                  grep(pattern = 'Col1A1', x = out_names_deltaCt_C, value = T)[Col1A1_vs_PPIB],
                                  grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = T)[ProCol1A2_vs_FKBP10],
                                  grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = T)[ProCol1A2_vs_LRP10],
                                  grep(pattern = 'ProCol1A2', x = out_names_deltaCt_C, value = T)[ProCol1A2_vs_PPIB]))

##### subtraction plot

par(mar=c(8,5,2,2));
RandoDiStats::TukeyCustomized(variable = as.numeric(variable_delta_Cts_Sel_T- variable_delta_Cts_Sel_C), 
                              factor = as.factor(paste0(factor_delta_Cts_Sel_C,"_min_",factor_delta_Cts_Sel_T)),
                              returnObject = "Letters")


##### ratios of COL1A1 and COL1A2 across treatments

par(mar=c(8,5,2,2));
RandoDiStats::TukeyCustomized(variable = as.numeric(c((variable_delta_Cts_Sel_C[1:9]-variable_delta_Cts_Sel_C[10:18]), (variable_delta_Cts_Sel_T[1:9]-variable_delta_Cts_Sel_T[10:18]))), 
                              factor = as.factor(c(rep("FKBP10_C", 3),rep("LRP10_C", 3),rep("PPIB_C", 3),
  rep("FKBP10_T", 3),rep("LRP10_T", 3),rep("PPIB_T", 3))),
                              returnObject = "Letters", MainTitle = "Ratio Between COL1A1 & COL1A2 Expression", ylabTukeys = "Ct(COL1A1) - Ct(COL1A2)")


```

